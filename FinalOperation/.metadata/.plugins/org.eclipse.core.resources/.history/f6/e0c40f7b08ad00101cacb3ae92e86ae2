package controller;

import model.Employee;
import service.EmployeeService;
import service.impl.EmployeeServiceImpl;
import util.UiKit;

import javax.swing.*;

public class EmployeeLogin extends JFrame {
    private static final long serialVersionUID = 1L;

    private final JFrame back;
    private JTextField tCode;

    public EmployeeLogin(JFrame back) {
        this.back = back;
        setSize(360, 200);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        setLayout(null);
        UiKit.attachClockToTitle(this, "員工登入");
        UiKit.createBackButton(this, e -> { if (back!=null) back.setVisible(true); dispose(); });

        JLabel l1=new JLabel("員工編號："); l1.setBounds(40,60,80,24); add(l1);
        tCode=new JTextField(); tCode.setBounds(120,60,180,24); add(tCode);

        JButton btn=new JButton("登入"); btn.setBounds(120,100,90,28); add(btn);
        btn.addActionListener(e -> doLogin());
    }

    private void doLogin() {
        String code = tCode.getText().trim();
        if (code.isEmpty()){ JOptionPane.showMessageDialog(this,"請輸入員工編號"); return; }
        EmployeeService svc = new EmployeeServiceImpl();
        Employee emp = svc.loginByCode(code);
        if (emp == null) { JOptionPane.showMessageDialog(this,"查無此員工或已離職"); return; }
        new EmployeePanel(emp, this).setVisible(true);
        dispose();
    }
}
